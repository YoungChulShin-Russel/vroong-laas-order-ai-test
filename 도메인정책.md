# ë¶€ë¦‰ ì˜¤ë” ì„œë¹„ìŠ¤ - ë„ë©”ì¸ ì •ì±…

## ğŸ“‹ ê°œìš”

ë¶€ë¦‰ ì˜¤ë” ì„œë¹„ìŠ¤ëŠ” ì£¼ë¬¸ì„ ë°›ì•„ ë°°ì†¡ ë° ë°°ì°¨ ì„œë¹„ìŠ¤ê°€ í™œìš©í•  ìˆ˜ ìˆë„ë¡ ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•˜ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

---

## ğŸ¯ í•µì‹¬ ë„ë©”ì¸ ëª¨ë¸

### Order (ì£¼ë¬¸)

ì£¼ë¬¸ì˜ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬í•˜ëŠ” Aggregate Rootì…ë‹ˆë‹¤.

#### í•„ìˆ˜ ì†ì„±
- **ì£¼ë¬¸ë²ˆí˜¸ (OrderNumber)**: ì£¼ë¬¸ì„ ê³ ìœ í•˜ê²Œ ì‹ë³„
- **ì¶œë°œì§€ (Origin)**: ìƒí’ˆ í”½ì—… ìœ„ì¹˜
- **ë„ì°©ì§€ (Destination)**: ë°°ì†¡ ëª©ì ì§€
- **ë°°ì†¡ ì •ì±… (DeliveryPolicy)**: ë°°ì†¡ ê´€ë ¨ ì„¤ì • (ì£¼ë¥˜ ë°°ì†¡, ë¹„ëŒ€ë©´ ë°°ì†¡ ë“±)

#### ì„ íƒ ì†ì„±
- **ì£¼ë¬¸ ì•„ì´í…œ (OrderItem)**: ì£¼ë¬¸ ìƒí’ˆ ëª©ë¡ (ì—†ì„ ìˆ˜ ìˆìŒ)

---

## ğŸ“ ë„ë©”ì¸ ê·œì¹™

### 1. ì£¼ë¬¸ë²ˆí˜¸ (OrderNumber)

**í¬ë§· ê·œì¹™:**
- ë°˜ë“œì‹œ `"ORD-"`ë¡œ ì‹œì‘í•´ì•¼ í•¨
- ì˜ˆ: `"ORD-20251002-001"`

**ê²€ì¦:**
```java
OrderNumber orderNumber = OrderNumber.of("ORD-20251002-001"); // âœ… ì„±ê³µ
OrderNumber orderNumber = OrderNumber.of("ORDER-001");         // âŒ ì˜ˆì™¸
OrderNumber orderNumber = OrderNumber.of("ord-001");           // âŒ ì˜ˆì™¸ (ì†Œë¬¸ì ë¶ˆê°€)
```

---

### 2. ì£¼ë¬¸ ìƒíƒœ (OrderStatus)

ì£¼ë¬¸ì€ ë‹¤ìŒ 3ê°€ì§€ ìƒíƒœë¥¼ ê°€ì§‘ë‹ˆë‹¤:

| ìƒíƒœ | ì„¤ëª… | ì „ì´ ê°€ëŠ¥ ìƒíƒœ |
|------|------|----------------|
| **CREATED** | ìƒì„± | DELIVERED, CANCELLED |
| **DELIVERED** | ë°°ì†¡ì™„ë£Œ | (ìµœì¢… ìƒíƒœ) |
| **CANCELLED** | ì·¨ì†Œ | (ìµœì¢… ìƒíƒœ) |

**ìƒíƒœ ì „ì´ ê·œì¹™:**

```java
// CREATED â†’ DELIVERED
Order order = Order.create(...);
order.markAsDelivered();  // âœ… ì„±ê³µ

// CREATED â†’ CANCELLED
Order order = Order.create(...);
order.cancel();  // âœ… ì„±ê³µ

// DELIVERED â†’ CANCELLED
Order deliveredOrder = ...;
deliveredOrder.cancel();  // âŒ ì˜ˆì™¸: "ë°°ì†¡ ì™„ë£Œëœ ì£¼ë¬¸ì€ ì·¨ì†Œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"

// CANCELLED â†’ DELIVERED
Order cancelledOrder = ...;
cancelledOrder.markAsDelivered();  // âŒ ì˜ˆì™¸: "ì·¨ì†Œëœ ì£¼ë¬¸ì€ ë°°ì†¡ ì™„ë£Œ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
```

---

### 3. ì£¼ë¬¸ ìƒì„±

**íŒ©í† ë¦¬ ë©”ì„œë“œ:**
```java
Order order = Order.create(
    "ORD-20251002-001",      // orderNumber (í•„ìˆ˜)
    List.of(orderItems),     // items (ì„ íƒ, null ê°€ëŠ¥)
    origin,                  // origin (í•„ìˆ˜)
    destination,             // destination (í•„ìˆ˜)
    deliveryPolicy          // deliveryPolicy (í•„ìˆ˜)
);
```

**í•„ìˆ˜ ê°’ ê²€ì¦:**
- `orderNumber`: null ë¶ˆê°€, "ORD-"ë¡œ ì‹œì‘
- `origin`: null ë¶ˆê°€
- `destination`: null ë¶ˆê°€
- `deliveryPolicy`: null ë¶ˆê°€
- `items`: null ê°€ëŠ¥ (ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¡œ ì´ˆê¸°í™”)

---

### 4. ë°°ì†¡ ì •ì±… (DeliveryPolicy)

ë°°ì†¡ê³¼ ê´€ë ¨ëœ ë‹¤ì–‘í•œ ì •ì±…ì„ ì •ì˜í•©ë‹ˆë‹¤.

**êµ¬ì„± ìš”ì†Œ:**
```java
DeliveryPolicy policy = new DeliveryPolicy(
    true,                           // alcoholDelivery (ì£¼ë¥˜ ë°°ì†¡)
    false,                          // contactlessDelivery (ë¹„ëŒ€ë©´ ë°°ì†¡)
    true,                           // reservedDelivery (ì˜ˆì•½ ë°°ì†¡)
    Instant.parse("2025-10-02T15:00:00Z"),  // reservedDeliveryStartTime
    Instant.parse("2025-10-02T14:30:00Z")   // pickupRequestTime
);
```

---

### 5. ìœ„ì¹˜ ì •ë³´

#### Origin (ì¶œë°œì§€)
```java
Origin origin = new Origin(
    new Address("06234", "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123", "10ì¸µ"),
    new LatLng(new BigDecimal("37.5012"), new BigDecimal("127.0396")),
    new Contact("í™ê¸¸ë™", "010-1234-5678")
);
```

#### Destination (ë„ì°©ì§€)
```java
Destination destination = new Destination(
    new Address("06234", "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 456", "5ì¸µ"),
    new LatLng(new BigDecimal("37.5008"), new BigDecimal("127.0382")),
    new Contact("ê¹€ì² ìˆ˜", "010-9876-5432"),
    new EntranceInfo("1234", "ê²½ë¹„ì‹¤ í†µê³¼", "ë¹ ë¥¸ ë°°ì†¡ ë¶€íƒë“œë ¤ìš”")
);
```

---

### 6. ì£¼ë¬¸ ì•„ì´í…œ (OrderItem)

ê°œë³„ ì£¼ë¬¸ ìƒí’ˆì˜ ì •ë³´ë¥¼ ë‹´ìŠµë‹ˆë‹¤.

```java
OrderItem item = new OrderItem(
    "ë§¥ì£¼ 24ìº”",                          // name
    2,                                   // quantity
    new Money(new BigDecimal("30000")),  // unitPrice
    "ì£¼ë¥˜"                                // category
);

// ì´ ê¸ˆì•¡ ê³„ì‚°
Money totalPrice = item.getTotalPrice();  // 60000ì› (30000 Ã— 2)
```

---

## ğŸ”„ ì´ë²¤íŠ¸ ê¸°ë°˜ ì²˜ë¦¬

### ë°°ì†¡ ì™„ë£Œ
- ë°°ì†¡ ì„œë¹„ìŠ¤ë¡œë¶€í„° ë°°ì†¡ ì™„ë£Œ ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì‹ 
- `Order.markAsDelivered()` í˜¸ì¶œ
- ìƒíƒœë¥¼ `DELIVERED`ë¡œ ë³€ê²½

### ì£¼ë¬¸ ì·¨ì†Œ
- ê³ ê° ë˜ëŠ” ì‹œìŠ¤í…œì˜ ì·¨ì†Œ ìš”ì²­
- `Order.cancel()` í˜¸ì¶œ
- ìƒíƒœë¥¼ `CANCELLED`ë¡œ ë³€ê²½

---

## ğŸ’° ê¸ˆì•¡ ê³„ì‚°

### ì£¼ë¬¸ ì´ì•¡
```java
Order order = ...;
Money totalAmount = order.calculateTotalAmount();
```

- ëª¨ë“  OrderItemì˜ ì´ì•¡ì„ í•©ì‚°
- OrderItemì´ ì—†ìœ¼ë©´ `Money.zero()` ë°˜í™˜

---

## ğŸ“Œ Value Object ë¶ˆë³€ ì›ì¹™

Value ObjectëŠ” ìƒì„± í›„ ê°’ì„ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤:
- `OrderNumber`
- `Money`
- `Address`
- `Contact`
- `LatLng`
- `EntranceInfo`
- `OrderItem`
- `Origin`
- `Destination`
- `DeliveryPolicy`

**ê·œì¹™:**
- í•œ ë²ˆ ìƒì„±ëœ Value ObjectëŠ” ìˆ˜ì • ë¶ˆê°€
- ìƒˆë¡œìš´ ê°’ì´ í•„ìš”í•˜ë©´ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±
- ì˜ˆ: ê¸ˆì•¡ 10,000ì› + 10,000ì› = ìƒˆë¡œìš´ 20,000ì› ê°ì²´

---

## ğŸš« ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ìœ„ë°˜ ì‚¬ë¡€

### 1. ì˜ëª»ëœ ìƒíƒœ ì „ì´
```
âŒ ë°°ì†¡ ì™„ë£Œëœ ì£¼ë¬¸ì„ ì·¨ì†Œ
âŒ ì·¨ì†Œëœ ì£¼ë¬¸ì„ ë°°ì†¡ ì™„ë£Œ ì²˜ë¦¬
âŒ ì£¼ë¬¸ë²ˆí˜¸ ë³€ê²½ ì‹œë„
```

### 2. í•„ìˆ˜ ê°’ ëˆ„ë½
```
âŒ ì¶œë°œì§€ ì—†ëŠ” ì£¼ë¬¸
âŒ ë„ì°©ì§€ ì—†ëŠ” ì£¼ë¬¸
âŒ ë°°ì†¡ ì •ì±… ì—†ëŠ” ì£¼ë¬¸
âŒ "ORD-"ë¡œ ì‹œì‘í•˜ì§€ ì•ŠëŠ” ì£¼ë¬¸ë²ˆí˜¸
```

### 3. Value Object ìˆ˜ì • ì‹œë„
```
âŒ ì£¼ë¬¸ë²ˆí˜¸ ë³€ê²½
âŒ ê¸ˆì•¡ ì§ì ‘ ìˆ˜ì •
âŒ ì£¼ì†Œ ì •ë³´ ë³€ê²½
âŒ ì—°ë½ì²˜ ì •ë³´ ë³€ê²½
```

**ì˜¬ë°”ë¥¸ ë°©ë²•:** ìƒˆë¡œìš´ ì£¼ë¬¸ì„ ìƒì„±í•˜ê±°ë‚˜, í—ˆìš©ëœ ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œ ì‚¬ìš©
