---
alwaysApply: true
---
## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬

```gradle
dependencies {
    // JUnit 5
    testImplementation 'org.junit.jupiter:junit-jupiter:5.10.0'
    
    // AssertJ (ê°€ë…ì„± ì¢‹ì€ assertion)
    testImplementation 'org.assertj:assertj-core:3.24.0'
    
    // Mockito (Mock ê°ì²´)
    testImplementation 'org.mockito:mockito-core:5.5.0'
    testImplementation 'org.mockito:mockito-junit-jupiter:5.5.0'
    
    // Fixture Monkey (í…ŒìŠ¤íŠ¸ ê°ì²´ ìƒì„±)
    testImplementation 'com.navercorp.fixturemonkey:fixture-monkey-starter:1.0.0'
    
    // Spring Boot Test
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}
```

### ì£¼ìš” ë„êµ¬

| ë„êµ¬ | ìš©ë„ | ì‚¬ìš© ìœ„ì¹˜ |
|------|------|-----------|
| **JUnit 5** | í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ | ëª¨ë“  í…ŒìŠ¤íŠ¸ |
| **AssertJ** | Assertion | ëª¨ë“  í…ŒìŠ¤íŠ¸ |
| **Mockito** | Mock ê°ì²´ | Application, Interface Layer |
| **Fixture Monkey** | í…ŒìŠ¤íŠ¸ ê°ì²´ ìƒì„± | ëª¨ë“  í…ŒìŠ¤íŠ¸ |
| **@DataJpaTest** | Repository í…ŒìŠ¤íŠ¸ | Infrastructure Layer |
| **@WebMvcTest** | Controller í…ŒìŠ¤íŠ¸ | Interface Layer |

---

## ğŸ“‹ ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ ì „ëµ

### 1. Domain Layer í…ŒìŠ¤íŠ¸

**íŠ¹ì§•:**
- ìˆœìˆ˜ Java ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- ì™¸ë¶€ ì˜ì¡´ì„± ì—†ìŒ
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦

**í…ŒìŠ¤íŠ¸ ëŒ€ìƒ:**
- Domain Entity
- Value Object
- Domain Service
- Domain Exception

**ì˜ˆì‹œ:**
```java
// core/src/test/java/vroong/laas/order/domain/order/OrderTest.java
class OrderTest {
    
    private FixtureMonkey fixtureMonkey;
    
    @BeforeEach
    void setUp() {
        fixtureMonkey = FixtureMonkey.builder()
            .objectIntrospector(ConstructorPropertiesArbitraryIntrospector.INSTANCE)
            .build();
    }
    
    @Test
    @DisplayName("ì£¼ë¬¸ì„ ì·¨ì†Œí•˜ë©´ ìƒíƒœê°€ CANCELLEDë¡œ ë³€ê²½ëœë‹¤")
    void cancel_order_changes_status_to_cancelled() {
        // given
        Order order = fixtureMonkey.giveMeBuilder(Order.class)
            .set("status", OrderStatus.PENDING)
            .sample();
        
        String reason = "ê³ ê° ìš”ì²­";
        
        // when
        order.cancel(reason);
        
        // then
        assertThat(order.getStatus()).isEqualTo(OrderStatus.CANCELLED);
        assertThat(order.getCancelReason()).isEqualTo(reason);
    }
    
    @Test
    @DisplayName("ì´ë¯¸ ì·¨ì†Œëœ ì£¼ë¬¸ì€ ë‹¤ì‹œ ì·¨ì†Œí•  ìˆ˜ ì—†ë‹¤")
    void cannot_cancel_already_cancelled_order() {
        // given
        Order order = fixtureMonkey.giveMeBuilder(Order.class)
            .set("status", OrderStatus.CANCELLED)
            .sample();
        
        // when & then
        assertThatThrownBy(() -> order.cancel("ì¬ì·¨ì†Œ"))
            .isInstanceOf(OrderAlreadyCancelledException.class)
            .hasMessage("ì´ë¯¸ ì·¨ì†Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤");
    }
}
```

---

### ğŸ“Œ Domain Layer í…ŒìŠ¤íŠ¸ ì‹¤ì „ ê°€ì´ë“œ

#### 1. Spring Context ì‚¬ìš© ê¸ˆì§€ â­â­â­

**Domain LayerëŠ” ìˆœìˆ˜ Java í…ŒìŠ¤íŠ¸ì—¬ì•¼ í•©ë‹ˆë‹¤. Spring ì˜ì¡´ì„± ì ˆëŒ€ ê¸ˆì§€!**

```java
// âŒ ì˜ëª»ëœ ì˜ˆ - Spring Context ì‚¬ìš©
@Component  // ê¸ˆì§€!
public class OrderFixtures {
    @Autowired
    private FixtureMonkey fixtureMonkey;  // ê¸ˆì§€!
}

@SpringBootTest  // Domain Layerì—ì„œ ê¸ˆì§€!
class OrderTest {
    @Autowired
    private OrderFixtures fixtures;
}

// âœ… ì˜¬ë°”ë¥¸ ì˜ˆ - ìˆœìˆ˜ Java
public class OrderFixtures {
    private final FixtureMonkey fixtureMonkey;
    
    public OrderFixtures(FixtureMonkey fixtureMonkey) {
        this.fixtureMonkey = fixtureMonkey;
    }
}

class OrderTest {
    private OrderFixtures orderFixtures;
    
    @BeforeEach
    void setUp() {
        FixtureMonkey fixtureMonkey = FixtureMonkey.builder()
            .objectIntrospector(ConstructorPropertiesArbitraryIntrospector.INSTANCE)
            .defaultNotNull(true)
            .build();
        
        orderFixtures = new OrderFixtures(fixtureMonkey);
    }
}
```

**ì™œ ì¤‘ìš”í•œê°€?**
- Domain LayerëŠ” Infrastructureì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ
- ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (Spring Context ë¡œë”© ì—†ìŒ)
- ìˆœìˆ˜í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦

---

#### 2. ìƒì„±ì vs íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´ â­â­â­

**ìƒì„±ìì—ì„œ í•„ìˆ˜ ê°’ ì²´í¬, create()ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ìš©**

```java
public class Order {
    
    // ìƒì„±ì - í•„ìˆ˜ ê°’ ì²´í¬ (í•­ìƒ ì‹¤í–‰)
    public Order(
        Long id,
        String orderNumber,
        OrderStatus status,
        List<OrderItem> items,
        Origin origin,
        Destination destination,
        DeliveryPolicy deliveryPolicy,
        Instant orderedAt,
        Instant deliveredAt,
        Instant cancelledAt
    ) {
        // í•„ìˆ˜ ê°’ ì²´í¬
        if (orderNumber == null || orderNumber.isBlank()) {
            throw new IllegalArgumentException("ì£¼ë¬¸ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤");
        }
        if (items == null || items.isEmpty()) {
            throw new IllegalArgumentException("ì£¼ë¬¸ ì•„ì´í…œì€ ìµœì†Œ 1ê°œ ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        }
        if (origin == null) {
            throw new IllegalArgumentException("ì¶œë°œì§€ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤");
        }
        if (destination == null) {
            throw new IllegalArgumentException("ë„ì°©ì§€ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤");
        }
        
        // í• ë‹¹
        this.id = id;
        this.orderNumber = orderNumber;
        this.status = status;
        this.items = new ArrayList<>(items);
        this.origin = origin;
        this.destination = destination;
        this.deliveryPolicy = deliveryPolicy;
        this.orderedAt = orderedAt;
        this.deliveredAt = deliveredAt;
        this.cancelledAt = cancelledAt;
    }
    
    // create() - ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ + ì´ˆê¸° ìƒíƒœë¡œ ìƒì„±
    public static Order create(
        String orderNumber,
        List<OrderItem> items,
        Origin origin,
        Destination destination,
        DeliveryPolicy deliveryPolicy
    ) {
        // ì¶”ê°€ ë¹„ì¦ˆë‹ˆìŠ¤ ê²€ì¦ (ì„ íƒì )
        validateBusinessRules(items, origin, destination);
        
        // ì´ˆê¸° ìƒíƒœë¡œ ìƒì„±
        return new Order(
            null,                  // idëŠ” ë‚˜ì¤‘ì— í• ë‹¹
            orderNumber,
            OrderStatus.CREATED,   // ì´ˆê¸° ìƒíƒœ
            items,
            origin,
            destination,
            deliveryPolicy,
            Instant.now(),         // í˜„ì¬ ì‹œê°„
            null,                  // deliveredAt
            null                   // cancelledAt
        );
    }
}
```

**ì‚¬ìš© êµ¬ë¶„:**

| ë°©ë²• | ìš©ë„ | ê²€ì¦ | ì‚¬ìš©ì²˜ |
|------|------|------|--------|
| **`create()`** | ìƒˆ ì£¼ë¬¸ ìƒì„± | ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ âœ… | í”„ë¡œë•ì…˜ (UseCase) |
| **ìƒì„±ì** | ê°ì²´ ë³µì›/í…ŒìŠ¤íŠ¸ | í•„ìˆ˜ ê°’ë§Œ âœ… | í…ŒìŠ¤íŠ¸, Infrastructure |

```java
// í”„ë¡œë•ì…˜ - create() ì‚¬ìš©
Order order = Order.create(
    "ORD-001", items, origin, destination, policy
);

// í…ŒìŠ¤íŠ¸ - ìƒì„±ì ì§ì ‘ ì‚¬ìš© (ë‹¤ì–‘í•œ ìƒíƒœ)
Order deliveredOrder = new Order(
    1L, "ORD-001", OrderStatus.DELIVERED, items, 
    origin, destination, policy,
    Instant.now().minusSeconds(3600),
    Instant.now(),  // deliveredAt
    null
);

// Infrastructure - ìƒì„±ì ì‚¬ìš© (DB â†’ Domain)
public Order toDomain() {
    return new Order(
        this.id, this.orderNumber, this.status,
        this.items.stream()...
    );
}
```

---

#### 3. ConstructorPropertiesArbitraryIntrospector í•„ìˆ˜ â­â­â­

**record, ë¶ˆë³€ ê°ì²´ë¥¼ ìœ„í•´ ë°˜ë“œì‹œ ì„¤ì •!**

```java
// âœ… í•„ìˆ˜ ì„¤ì •
FixtureMonkey fixtureMonkey = FixtureMonkey.builder()
    .objectIntrospector(ConstructorPropertiesArbitraryIntrospector.INSTANCE)  // â­
    .defaultNotNull(true)  // null ë°©ì§€
    .build();

// recordì—ì„œ ì‘ë™
public record Contact(String name, String phoneNumber) { }

Contact contact = fixtureMonkey.giveMeOne(Contact.class);  // âœ… ì‘ë™!

// ë¶ˆë³€ ê°ì²´ì—ì„œ ì‘ë™
@Getter
@AllArgsConstructor
public class Order {
    private final String orderNumber;
    // ...
}

Order order = fixtureMonkey.giveMeOne(Order.class);  // âœ… ì‘ë™!
```

**ì—†ìœ¼ë©´?**
```java
// âŒ ConstructorPropertiesArbitraryIntrospector ì—†ì´
FixtureMonkey fixtureMonkey = FixtureMonkey.builder().build();

Contact contact = fixtureMonkey.giveMeOne(Contact.class);
// â†’ ì—ëŸ¬! recordëŠ” ê¸°ë³¸ ìƒì„±ìê°€ ì—†ìŒ
```

---

#### 4. Arbitrariesì™€ FixtureMonkey ì¡°í•© â­â­

**ë²”ìœ„ê°€ ìˆëŠ” ëœë¤ ê°’ ìƒì„±**

```java
import net.jqwik.api.Arbitraries;

public class OrderFixtures {
    
    private final FixtureMonkey fixtureMonkey;
    
    // Arbitrariesë¡œ ë²”ìœ„ ì§€ì •
    public OrderItem randomOrderItem() {
        String itemName = "ìƒí’ˆ" + fixtureMonkey.giveMeOne(Integer.class);
        int quantity = Arbitraries.integers().between(1, 10).sample();
        Money price = new Money(
            BigDecimal.valueOf(Arbitraries.longs().between(1000L, 100000L).sample())
        );
        String category = Arbitraries.of("ì‹í’ˆ", "ìƒí™œìš©í’ˆ", "ì˜ë¥˜", "ì „ìì œí’ˆ").sample();
        
        return new OrderItem(itemName, quantity, price, category, null, null);
    }
    
    // FixtureMonkey.giveMeBuilder()ì™€ Arbitraries ì¡°í•©
    public Contact randomContact() {
        return fixtureMonkey.giveMeBuilder(Contact.class)
            .set("name", "í…ŒìŠ¤í„°" + fixtureMonkey.giveMeOne(Integer.class))
            .set("phoneNumber", 
                "010-" + 
                Arbitraries.strings().numeric().ofLength(4).sample() + 
                "-" + 
                Arbitraries.strings().numeric().ofLength(4).sample())
            .sample();
    }
    
    public LatLng randomLatLng() {
        return fixtureMonkey.giveMeBuilder(LatLng.class)
            .set("latitude", 
                Arbitraries.doubles().between(37.0, 38.0)
                    .map(BigDecimal::valueOf))
            .set("longitude", 
                Arbitraries.doubles().between(126.0, 127.0)
                    .map(BigDecimal::valueOf))
            .sample();
    }
}
```

**ì£¼ìš” Arbitraries ë©”ì„œë“œ:**

```java
// ì •ìˆ˜ ë²”ìœ„
Arbitraries.integers().between(1, 10).sample()

// Long ë²”ìœ„
Arbitraries.longs().between(1000L, 100000L).sample()

// Double ë²”ìœ„
Arbitraries.doubles().between(37.0, 38.0).sample()

// ëª©ë¡ì—ì„œ ì„ íƒ
Arbitraries.of("A", "B", "C", "D").sample()

// ìˆ«ì ë¬¸ìì—´
Arbitraries.strings().numeric().ofLength(4).sample()  // "1234"

// ì•ŒíŒŒë²³ ë¬¸ìì—´
Arbitraries.strings().alpha().ofLength(10).sample()  // "abcdEFGHij"
```

---

#### 5. ì‹¤ì „ Fixture íŒ¨í„´ â­â­

**ìƒíƒœë³„ Fixture ë©”ì„œë“œ ì œê³µ**

```java
public class OrderFixtures {
    
    private final FixtureMonkey fixtureMonkey;
    
    public OrderFixtures(FixtureMonkey fixtureMonkey) {
        this.fixtureMonkey = fixtureMonkey;
    }
    
    // ê¸°ë³¸ ì£¼ë¬¸ (CREATED ìƒíƒœ)
    public Order order() {
        return new Order(
            null,
            generateOrderNumber(),
            OrderStatus.CREATED,
            randomOrderItems(),
            randomOrigin(),
            randomDestination(),
            randomDeliveryPolicy(),
            Instant.now(),
            null,
            null
        );
    }
    
    // íŠ¹ì • ì£¼ë¬¸ë²ˆí˜¸ë¡œ ìƒì„±
    public Order order(String orderNumber) {
        return new Order(
            null,
            orderNumber,
            OrderStatus.CREATED,
            randomOrderItems(),
            randomOrigin(),
            randomDestination(),
            randomDeliveryPolicy(),
            Instant.now(),
            null,
            null
        );
    }
    
    // ë°°ì†¡ì™„ë£Œ ì£¼ë¬¸
    public Order deliveredOrder() {
        return new Order(
            fixtureMonkey.giveMeOne(Long.class),
            generateOrderNumber(),
            OrderStatus.DELIVERED,
            randomOrderItems(),
            randomOrigin(),
            randomDestination(),
            randomDeliveryPolicy(),
            Instant.now().minusSeconds(3600),
            Instant.now(),  // deliveredAt
            null
        );
    }
    
    // ì·¨ì†Œëœ ì£¼ë¬¸
    public Order cancelledOrder() {
        return new Order(
            fixtureMonkey.giveMeOne(Long.class),
            generateOrderNumber(),
            OrderStatus.CANCELLED,
            randomOrderItems(),
            randomOrigin(),
            randomDestination(),
            randomDeliveryPolicy(),
            Instant.now().minusSeconds(3600),
            null,
            Instant.now()  // cancelledAt
        );
    }
    
    // íŠ¹ì • IDë¡œ ìƒì„±
    public Order orderWithId(Long id) {
        return new Order(
            id,
            generateOrderNumber(),
            OrderStatus.CREATED,
            randomOrderItems(),
            randomOrigin(),
            randomDestination(),
            randomDeliveryPolicy(),
            Instant.now(),
            null,
            null
        );
    }
    
    // íŠ¹ì • ìƒíƒœë¡œ ìƒì„±
    public Order orderWithStatus(OrderStatus status) {
        Instant deliveredAt = status == OrderStatus.DELIVERED ? Instant.now() : null;
        Instant cancelledAt = status == OrderStatus.CANCELLED ? Instant.now() : null;
        
        return new Order(
            null,
            generateOrderNumber(),
            status,
            randomOrderItems(),
            randomOrigin(),
            randomDestination(),
            randomDeliveryPolicy(),
            Instant.now().minusSeconds(3600),
            deliveredAt,
            cancelledAt
        );
    }
    
    // Value Object ëœë¤ ìƒì„± í—¬í¼
    public List<OrderItem> randomOrderItems() {
        int count = Math.abs(fixtureMonkey.giveMeOne(Integer.class) % 3) + 1;
        return List.of(
            randomOrderItem(),
            randomOrderItem(),
            randomOrderItem()
        ).subList(0, count);
    }
    
    public OrderItem randomOrderItem() {
        // Arbitraries í™œìš©
        String itemName = "ìƒí’ˆ" + Math.abs(fixtureMonkey.giveMeOne(Integer.class) % 1000);
        int quantity = Arbitraries.integers().between(1, 10).sample();
        Money price = new Money(
            BigDecimal.valueOf(Arbitraries.longs().between(1000L, 100000L).sample())
        );
        String category = Arbitraries.of("ì‹í’ˆ", "ìƒí™œìš©í’ˆ", "ì˜ë¥˜", "ì „ìì œí’ˆ").sample();
        
        return new OrderItem(itemName, quantity, price, category, null, null);
    }
    
    public Contact randomContact() {
        return fixtureMonkey.giveMeBuilder(Contact.class)
            .set("name", "í…ŒìŠ¤í„°" + fixtureMonkey.giveMeOne(Integer.class))
            .set("phoneNumber", 
                "010-" + 
                Arbitraries.strings().numeric().ofLength(4).sample() + 
                "-" + 
                Arbitraries.strings().numeric().ofLength(4).sample())
            .sample();
    }
    
    private String generateOrderNumber() {
        return "ORD-" + System.currentTimeMillis();
    }
}
```

**í…ŒìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©:**

```java
class OrderTest {
    
    private OrderFixtures orderFixtures;
    
    @BeforeEach
    void setUp() {
        FixtureMonkey fixtureMonkey = FixtureMonkey.builder()
            .objectIntrospector(ConstructorPropertiesArbitraryIntrospector.INSTANCE)
            .defaultNotNull(true)
            .build();
        
        orderFixtures = new OrderFixtures(fixtureMonkey);
    }
    
    @Test
    void test_with_created_order() {
        Order order = orderFixtures.order();
        // í…ŒìŠ¤íŠ¸...
    }
    
    @Test
    void test_with_delivered_order() {
        Order order = orderFixtures.deliveredOrder();
        // í…ŒìŠ¤íŠ¸...
    }
    
    @Test
    void test_with_specific_status() {
        Order order = orderFixtures.orderWithStatus(OrderStatus.CANCELLED);
        // í…ŒìŠ¤íŠ¸...
    }
}
```

---

### 2. Application Layer í…ŒìŠ¤íŠ¸

**íŠ¹ì§•:**
- UseCase í…ŒìŠ¤íŠ¸
- Mockìœ¼ë¡œ Port ëŒ€ì²´
- íë¦„ ê²€ì¦ (Given-When-Then)

**í…ŒìŠ¤íŠ¸ ëŒ€ìƒ:**
- UseCase
- Command/Query

**ì˜ˆì‹œ:**
```java
// core/src/test/java/vroong/laas/order/application/order/CancelOrderUseCaseTest.java
@ExtendWith(MockitoExtension.class)
class CancelOrderUseCaseTest {
    
    @InjectMocks
    private CancelOrderUseCase sut;
    
    @Mock
    private OrderStore orderStore;
    
    @Mock
    private EventPublisher eventPublisher;
    
    private FixtureMonkey fixtureMonkey;
    
    @BeforeEach
    void setUp() {
        fixtureMonkey = FixtureMonkey.builder()
            .objectIntrospector(ConstructorPropertiesArbitraryIntrospector.INSTANCE)
            .build();
    }
    
    @Test
    @DisplayName("ì£¼ë¬¸ì„ ì·¨ì†Œí•˜ê³  ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•œë‹¤")
    void cancel_order_and_publish_event() {
        // given
        Long orderId = 1L;
        String reason = "ê³ ê° ìš”ì²­";
        
        Order order = fixtureMonkey.giveMeBuilder(Order.class)
            .set("id", orderId)
            .set("status", OrderStatus.PENDING)
            .sample();
        
        given(orderStore.findById(orderId))
            .willReturn(Optional.of(order));
        
        CancelOrderCommand command = new CancelOrderCommand(orderId, reason);
        
        // when
        sut.execute(command);
        
        // then
        assertThat(order.getStatus()).isEqualTo(OrderStatus.CANCELLED);
        
        verify(orderStore).save(order);
        verify(eventPublisher).publish(any(OrderCancelledEvent.class));
    }
    
    @Test
    @DisplayName("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì£¼ë¬¸ì€ ì·¨ì†Œí•  ìˆ˜ ì—†ë‹¤")
    void cannot_cancel_non_existing_order() {
        // given
        Long orderId = 999L;
        
        given(orderStore.findById(orderId))
            .willReturn(Optional.empty());
        
        CancelOrderCommand command = new CancelOrderCommand(orderId, "ì‚¬ìœ ");
        
        // when & then
        assertThatThrownBy(() -> sut.execute(command))
            .isInstanceOf(OrderNotFoundException.class);
        
        verify(orderStore, never()).save(any());
        verify(eventPublisher, never()).publish(any());
    }
}
```

---

### 3. Infrastructure Layer í…ŒìŠ¤íŠ¸

**íŠ¹ì§•:**
- Repository í†µí•© í…ŒìŠ¤íŠ¸
- @DataJpaTest ì‚¬ìš©
- ì‹¤ì œ DB(H2) ì‚¬ìš©

**í…ŒìŠ¤íŠ¸ ëŒ€ìƒ:**
- Repository Adapter
- JPA Entity
- Query

**ì˜ˆì‹œ:**
```java
// infrastructure/src/test/java/vroong/laas/order/infrastructure/storage/db/order/OrderStoreAdapterTest.java
@DataJpaTest
@Import(OrderStoreAdapter.class)
class OrderStoreAdapterTest {
    
    @Autowired
    private OrderStoreAdapter orderStoreAdapter;
    
    @Autowired
    private OrderJpaRepository orderJpaRepository;
    
    private FixtureMonkey fixtureMonkey;
    
    @BeforeEach
    void setUp() {
        fixtureMonkey = FixtureMonkey.builder()
            .objectIntrospector(ConstructorPropertiesArbitraryIntrospector.INSTANCE)
            .build();
    }
    
    @Test
    @DisplayName("ì£¼ë¬¸ì„ ì €ì¥í•˜ê³  ì¡°íšŒí•  ìˆ˜ ìˆë‹¤")
    void save_and_find_order() {
        // given
        Order order = fixtureMonkey.giveMeBuilder(Order.class)
            .set("id", null)  // ì‹ ê·œ ì£¼ë¬¸
            .set("status", OrderStatus.PENDING)
            .sample();
        
        // when
        Order saved = orderStoreAdapter.save(order);
        Order found = orderStoreAdapter.findById(saved.getId()).orElseThrow();
        
        // then
        assertThat(found.getId()).isEqualTo(saved.getId());
        assertThat(found.getStatus()).isEqualTo(OrderStatus.PENDING);
    }
    
    @Test
    @DisplayName("ì£¼ë¬¸ê³¼ ì•„ì´í…œì„ í•¨ê»˜ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤")
    void find_order_with_items() {
        // given
        OrderJpaEntity entity = fixtureMonkey.giveMeBuilder(OrderJpaEntity.class)
            .set("id", null)
            .size("items", 3)
            .sample();
        
        OrderJpaEntity saved = orderJpaRepository.save(entity);
        
        // when
        Order order = orderStoreAdapter.findByIdWithItems(saved.getId()).orElseThrow();
        
        // then
        assertThat(order.getItems()).hasSize(3);
    }
}
```

---

### 4. Interface Layer í…ŒìŠ¤íŠ¸

**íŠ¹ì§•:**
- Controller í…ŒìŠ¤íŠ¸
- @WebMvcTest ì‚¬ìš©
- API ê³„ì•½ ê²€ì¦

**í…ŒìŠ¤íŠ¸ ëŒ€ìƒ:**
- Controller
- Request/Response DTO
- Exception Handler

**ì˜ˆì‹œ:**
```java
// api/src/test/java/vroong/laas/order/api/web/order/OrderControllerTest.java
@WebMvcTest(OrderController.class)
class OrderControllerTest {
    
    @Autowired
    private MockMvc mockMvc;
    
    @MockBean
    private CancelOrderUseCase cancelOrderUseCase;
    
    @Autowired
    private ObjectMapper objectMapper;
    
    private FixtureMonkey fixtureMonkey;
    
    @BeforeEach
    void setUp() {
        fixtureMonkey = FixtureMonkey.builder()
            .objectIntrospector(ConstructorPropertiesArbitraryIntrospector.INSTANCE)
            .build();
    }
    
    @Test
    @DisplayName("ì£¼ë¬¸ ì·¨ì†Œ API - ì„±ê³µ")
    void cancel_order_success() throws Exception {
        // given
        Long orderId = 1L;
        
        CancelOrderRequest request = fixtureMonkey.giveMeBuilder(CancelOrderRequest.class)
            .set("reason", "ê³ ê° ìš”ì²­")
            .sample();
        
        // when & then
        mockMvc.perform(
                post("/api/orders/{orderId}/cancel", orderId)
                    .contentType(MediaType.APPLICATION_JSON)
                    .content(objectMapper.writeValueAsString(request))
            )
            .andExpect(status().isOk())
            .andExpect(jsonPath("$.success").value(true));
        
        verify(cancelOrderUseCase).execute(any(CancelOrderCommand.class));
    }
    
    @Test
    @DisplayName("ì£¼ë¬¸ ì·¨ì†Œ API - ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨")
    void cancel_order_validation_fail() throws Exception {
        // given
        Long orderId = 1L;
        
        CancelOrderRequest request = new CancelOrderRequest(null);  // reason ëˆ„ë½
        
        // when & then
        mockMvc.perform(
                post("/api/orders/{orderId}/cancel", orderId)
                    .contentType(MediaType.APPLICATION_JSON)
                    .content(objectMapper.writeValueAsString(request))
            )
            .andExpect(status().isBadRequest())
            .andExpect(jsonPath("$.errorCode").value("INVALID_INPUT"));
    }
}
```

---

## 5. REST Docs - API ë¬¸ì„œ ìë™ ìƒì„± â­

**íŠ¹ì§•:**
- Controller í…ŒìŠ¤íŠ¸ì™€ í•¨ê»˜ API ë¬¸ì„œ ìë™ ìƒì„±
- **@WebMvcTest ì‚¬ìš©** (Web Layerë§Œ ë¡œë“œ, ë¹ ë¥¸ ì‹¤í–‰)
- **FixtureMonkey ì‚¬ìš© ì•ˆ í•¨** (ì¼ê´€ëœ ë¬¸ì„œë¥¼ ìœ„í•´ ê³ ì • ë°ì´í„° ì‚¬ìš©)
- ì»¤ìŠ¤í…€ í…œí”Œë¦¿ìœ¼ë¡œ Constraints ì»¬ëŸ¼ ì¶”ê°€

### REST Docs í…ŒìŠ¤íŠ¸ í…œí”Œë¦¿

```java
// api/src/test/java/vroong/laas/order/api/web/order/OrderControllerTest.java
@WebMvcTest(
    controllers = OrderController.class,
    excludeFilters = @ComponentScan.Filter(
        type = FilterType.REGEX,
        pattern = "vroong.laas.order.api.web.common.logging.*"
    )
)
@AutoConfigureRestDocs
@Import({RestDocsConfiguration.class, WebApiControllerAdvice.class})
class OrderControllerTest {
    
    @Autowired
    private MockMvc mockMvc;
    
    @MockBean
    private OrderFacade orderFacade;
    
    @Autowired
    private ObjectMapper objectMapper;
    
    @Autowired
    private RestDocumentationResultHandler restDocs;
    
    @Test
    @DisplayName("ì£¼ë¬¸ ìƒì„± API")
    void createOrder_success() throws Exception {
        // given - ê³ ì •ëœ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚¬ìš© (FixtureMonkey ì‚¬ìš© ì•ˆ í•¨)
        CreateOrderRequest request = CreateOrderRequest.builder()
            .items(List.of(
                OrderItemDto.builder()
                    .itemName("ìƒí’ˆA")
                    .quantity(2)
                    .price(new BigDecimal("10000"))
                    .category("ì‹í’ˆ")
                    .build()
            ))
            .origin(OriginDto.builder()
                .contact(ContactDto.builder()
                    .name("ë°œì†¡ì")
                    .phoneNumber("010-1234-5678")
                    .build())
                .address(AddressDto.builder()
                    .jibnunAddress("ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123")
                    .roadAddress("ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123")
                    .detailAddress("1ì¸µ")
                    .build())
                .latLng(LatLngDto.builder()
                    .latitude(new BigDecimal("37.123456"))
                    .longitude(new BigDecimal("127.123456"))
                    .build())
                .build())
            .destination(DestinationDto.builder()
                .contact(ContactDto.builder()
                    .name("ìˆ˜ë ¹ì")
                    .phoneNumber("010-9876-5432")
                    .build())
                .address(AddressDto.builder()
                    .jibnunAddress("ì„œìš¸ì‹œ ì„œì´ˆêµ¬ ì„œì´ˆë™ 456")
                    .roadAddress("ì„œìš¸ì‹œ ì„œì´ˆêµ¬ ì„œì´ˆëŒ€ë¡œ 456")
                    .detailAddress("2ì¸µ")
                    .build())
                .latLng(LatLngDto.builder()
                    .latitude(new BigDecimal("37.234567"))
                    .longitude(new BigDecimal("127.234567"))
                    .build())
                .entranceInfo(EntranceInfoDto.builder()
                    .entrancePassword("1234")
                    .entranceNote("í˜„ê´€ ë¹„ë°€ë²ˆí˜¸ëŠ” 1234ì…ë‹ˆë‹¤")
                    .build())
                .build())
            .deliveryPolicy(DeliveryPolicyDto.builder()
                .pickupDueAt(Instant.now().plusSeconds(3600))
                .deliveryDueAt(Instant.now().plusSeconds(7200))
                .build())
            .build();
        
        Order mockOrder = Order.builder()
            .id(1L)
            .orderNumber(OrderNumber.of("ORD-20250112-001"))
            .status(OrderStatus.CREATED)
            .items(request.toItems())
            .origin(request.toOrigin())
            .destination(request.toDestination())
            .deliveryPolicy(request.toDeliveryPolicy())
            .orderedAt(Instant.now())
            .build();
        
        given(orderFacade.createOrder(any(CreateOrderCommand.class)))
            .willReturn(mockOrder);
        
        // when & then
        mockMvc.perform(post("/api/v1/orders")
                .contentType(APPLICATION_JSON)
                .content(objectMapper.writeValueAsString(request)))
            .andExpect(status().isCreated())
            .andExpect(jsonPath("$.id").value(1))
            .andExpect(jsonPath("$.orderNumber").value("ORD-20250112-001"))
            .andExpect(jsonPath("$.status").value("CREATED"))
            .andDo(restDocs.document(
                requestFields(
                    fieldWithPath("items[]").description("ì£¼ë¬¸ ì•„ì´í…œ ëª©ë¡")
                        .attributes(key("constraints").value("ìµœì†Œ 1ê°œ")),
                    fieldWithPath("items[].itemName").description("ìƒí’ˆëª…"),
                    fieldWithPath("items[].quantity").description("ìˆ˜ëŸ‰")
                        .attributes(key("constraints").value("1 ì´ìƒ")),
                    fieldWithPath("items[].price").description("ê°€ê²©"),
                    fieldWithPath("items[].category").description("ì¹´í…Œê³ ë¦¬"),
                    fieldWithPath("origin.contact.name").description("ë°œì†¡ì ì´ë¦„"),
                    fieldWithPath("origin.contact.phoneNumber").description("ë°œì†¡ì ì „í™”ë²ˆí˜¸"),
                    // ... ê¸°íƒ€ í•„ë“œ
                ),
                responseFields(
                    fieldWithPath("id").description("ì£¼ë¬¸ ID"),
                    fieldWithPath("orderNumber").description("ì£¼ë¬¸ ë²ˆí˜¸"),
                    fieldWithPath("status").description("ì£¼ë¬¸ ìƒíƒœ")
                        .attributes(key("constraints").value("CREATED, DELIVERED, CANCELLED")),
                    // ... ê¸°íƒ€ í•„ë“œ
                )
            ));
    }
}
```

### RestDocsConfiguration (ê³µí†µ ì„¤ì •)

```java
// api/src/test/java/vroong/laas/order/api/config/RestDocsConfiguration.java
@TestConfiguration
public class RestDocsConfiguration {
    
    @Bean
    public RestDocumentationResultHandler write() {
        return MockMvcRestDocumentation.document(
            "{class-name}/{method-name}",
            preprocessRequest(prettyPrint()),
            preprocessResponse(prettyPrint())
        );
    }
}
```

### ì»¤ìŠ¤í…€ í…œí”Œë¦¿ (Constraints ì»¬ëŸ¼ ì¶”ê°€)

**ì¤‘ìš”:** í…œí”Œë¦¿ ê²½ë¡œëŠ” ë°˜ë“œì‹œ `src/test/resources/org/springframework/restdocs/templates/asciidoctor/`ì´ì–´ì•¼ í•©ë‹ˆë‹¤. (Spring REST Docs ê³ ì • ê·œì¹™)

```
// api/src/test/resources/org/springframework/restdocs/templates/asciidoctor/request-fields.snippet
|===
|Path|Type|Description|Constraints

{{#fields}}
|{{#tableCellContent}}`+{{path}}+`{{/tableCellContent}}
|{{#tableCellContent}}`+{{type}}+`{{/tableCellContent}}
|{{#tableCellContent}}{{description}}{{/tableCellContent}}
|{{#tableCellContent}}{{#constraints}}{{.}}{{/constraints}}{{^constraints}}-{{/constraints}}{{/tableCellContent}}

{{/fields}}
|===
```

```
// api/src/test/resources/org/springframework/restdocs/templates/asciidoctor/response-fields.snippet
|===
|Path|Type|Description|Constraints

{{#fields}}
|{{#tableCellContent}}`+{{path}}+`{{/tableCellContent}}
|{{#tableCellContent}}`+{{type}}+`{{/tableCellContent}}
|{{#tableCellContent}}{{description}}{{/tableCellContent}}
|{{#tableCellContent}}{{#constraints}}{{.}}{{/constraints}}{{^constraints}}-{{/constraints}}{{/tableCellContent}}

{{/fields}}
|===
```

### ì£¼ìš” ê·œì¹™

1. **@WebMvcTest ì‚¬ìš© (í•„ìˆ˜)**
   - `@SpringBootTest` ëŒ€ì‹  `@WebMvcTest` ì‚¬ìš©
   - Web Layerë§Œ ë¡œë“œí•˜ì—¬ ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
   - í•„ìš”í•œ Beanì€ `@Import`ë¡œ ëª…ì‹œì  ì¶”ê°€

2. **FixtureMonkey ì‚¬ìš© ì•ˆ í•¨ (í•„ìˆ˜)**
   - REST DocsëŠ” ì¼ê´€ëœ ë¬¸ì„œê°€ í•„ìš”
   - ê³ ì •ëœ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚¬ìš©
   - ë¹Œë” íŒ¨í„´ìœ¼ë¡œ ê°€ë…ì„± ìˆê²Œ ì‘ì„±

3. **WebApiControllerAdvice Import (í•„ìˆ˜)**
   - `@WebMvcTest`ëŠ” `@ControllerAdvice`ë¥¼ ìë™ìœ¼ë¡œ ë¡œë“œí•˜ì§€ ì•ŠìŒ
   - `@Import({WebApiControllerAdvice.class})`ë¡œ ëª…ì‹œì  ì¶”ê°€

4. **RequestResponseLoggingFilter ì œì™¸ (í•„ìˆ˜)**
   - `@WebMvcTest`ëŠ” `LoggingProperties` Beanì„ ë¡œë“œí•˜ì§€ ì•ŠìŒ
   - `excludeFilters`ë¡œ ë¡œê¹… í•„í„° ì œì™¸

5. **ì»¤ìŠ¤í…€ í…œí”Œë¦¿ ê²½ë¡œ (ê³ ì •)**
   - ë°˜ë“œì‹œ `src/test/resources/org/springframework/restdocs/templates/asciidoctor/`
   - ë‹¤ë¥¸ ê²½ë¡œëŠ” Spring REST Docsê°€ ì¸ì‹í•˜ì§€ ëª»í•¨

### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `@WebMvcTest` ì‚¬ìš© (not `@SpringBootTest`)
- [ ] `@AutoConfigureRestDocs` ì¶”ê°€
- [ ] `@Import({RestDocsConfiguration.class, WebApiControllerAdvice.class})` ì¶”ê°€
- [ ] `excludeFilters`ë¡œ `RequestResponseLoggingFilter` ì œì™¸
- [ ] FixtureMonkey ì œê±°, ê³ ì • ë°ì´í„° ì‚¬ìš©
- [ ] ì»¤ìŠ¤í…€ í…œí”Œë¦¿ ê²½ë¡œ í™•ì¸ (`org/springframework/restdocs/templates/asciidoctor/`)
- [ ] Constraints ì¶”ê°€ (`.attributes(key("constraints").value(...))`)

### ìì£¼í•˜ëŠ” ì‹¤ìˆ˜

**âŒ ì˜ëª»ëœ í…œí”Œë¦¿ ê²½ë¡œ**
```
src/test/resources/restdocs/templates/asciidoctor/  â† ì¸ì‹ ì•ˆ ë¨!
```

**âœ… ì˜¬ë°”ë¥¸ í…œí”Œë¦¿ ê²½ë¡œ**
```
src/test/resources/org/springframework/restdocs/templates/asciidoctor/  â† í•„ìˆ˜!
```

**âŒ FixtureMonkey ì‚¬ìš©**
```java
Order order = fixtureMonkey.giveMeOne(Order.class);  // ëœë¤ ë°ì´í„° â†’ ë¬¸ì„œê°€ ë§¤ë²ˆ ë‹¬ë¼ì§
```

**âœ… ê³ ì • ë°ì´í„° ì‚¬ìš©**
```java
Order order = Order.builder()
    .id(1L)
    .orderNumber(OrderNumber.of("ORD-20250112-001"))
    .build();  // ê³ ì • ë°ì´í„° â†’ ì¼ê´€ëœ ë¬¸ì„œ
```

**âŒ @SpringBootTest ì‚¬ìš©**
```java
@SpringBootTest  // ì „ì²´ Context ë¡œë“œ â†’ ëŠë¦¼
@AutoConfigureMockMvc
class OrderControllerTest { }
```

**âœ… @WebMvcTest ì‚¬ìš©**
```java
@WebMvcTest(OrderController.class)  // Web Layerë§Œ ë¡œë“œ â†’ ë¹ ë¦„
@AutoConfigureRestDocs
class OrderControllerTest { }
```

---

## ğŸ¯ Fixture Monkey ì‚¬ìš© ê·œì¹™

### 1. ì„¤ì •

**ê³µí†µ Fixture ì„¤ì • í´ë˜ìŠ¤ ì‘ì„±:**

```java
// src/test/java/vroong/laas/order/fixtures/FixtureConfig.java
@TestConfiguration
public class FixtureConfig {
    
    @Bean
    public FixtureMonkey fixtureMonkey() {
        return FixtureMonkey.builder()
            .objectIntrospector(ConstructorPropertiesArbitraryIntrospector.INSTANCE)
            .defaultNotNull(true)
            .build();
    }
}
```

---

### 2. ê¸°ë³¸ ì‚¬ìš©ë²•

#### ë‹¨ì¼ ê°ì²´ ìƒì„±
```java
// ëœë¤ ê°ì²´
Order order = fixtureMonkey.giveMeOne(Order.class);

// ì—¬ëŸ¬ ê°ì²´
List<Order> orders = fixtureMonkey.giveMe(Order.class, 10);
```

#### ì»¤ìŠ¤í„°ë§ˆì´ì§•
```java
// Builder íŒ¨í„´
Order order = fixtureMonkey.giveMeBuilder(Order.class)
    .set("status", OrderStatus.CONFIRMED)
    .set("totalAmount", Money.of(10000))
    .set("items[0].quantity", 5)
    .sample();

// í•„ë“œ ì œì™¸
Order order = fixtureMonkey.giveMeBuilder(Order.class)
    .setNull("cancelReason")
    .sample();

// ë²”ìœ„ ì§€ì •
Order order = fixtureMonkey.giveMeBuilder(Order.class)
    .size("items", 3, 5)  // 3~5ê°œ
    .sample();
```

---

### 3. ì¬ì‚¬ìš© ê°€ëŠ¥í•œ Fixture í´ë˜ìŠ¤

**ìœ„ì¹˜:** `src/test/java/.../fixtures/`

**ë„¤ì´ë°:** `{Entity}Fixtures.java`

**ì˜ˆì‹œ:**
```java
// src/test/java/vroong/laas/order/fixtures/OrderFixtures.java
@Component
public class OrderFixtures {
    
    private final FixtureMonkey fixtureMonkey;
    
    public OrderFixtures(FixtureMonkey fixtureMonkey) {
        this.fixtureMonkey = fixtureMonkey;
    }
    
    // ê¸°ë³¸ ì£¼ë¬¸
    public ArbitraryBuilder<Order> order() {
        return fixtureMonkey.giveMeBuilder(Order.class)
            .set("status", OrderStatus.PENDING);
    }
    
    // í™•ì •ëœ ì£¼ë¬¸
    public ArbitraryBuilder<Order> confirmedOrder() {
        return order()
            .set("status", OrderStatus.CONFIRMED)
            .set("confirmedAt", LocalDateTime.now());
    }
    
    // ì·¨ì†Œëœ ì£¼ë¬¸
    public ArbitraryBuilder<Order> cancelledOrder() {
        return order()
            .set("status", OrderStatus.CANCELLED)
            .set("cancelReason", "ê³ ê° ìš”ì²­");
    }
    
    // íŠ¹ì • ê¸ˆì•¡ì˜ ì£¼ë¬¸
    public ArbitraryBuilder<Order> orderWithAmount(Money amount) {
        return order()
            .set("totalAmount", amount);
    }
}
```

**ì‚¬ìš©:**
```java
@SpringBootTest
class OrderServiceTest {
    
    @Autowired
    private OrderFixtures orderFixtures;
    
    @Test
    void test() {
        // í™•ì •ëœ ì£¼ë¬¸ ìƒì„±
        Order order = orderFixtures.confirmedOrder().sample();
        
        // ì¶”ê°€ ì»¤ìŠ¤í„°ë§ˆì´ì§•
        Order customOrder = orderFixtures.confirmedOrder()
            .set("totalAmount", Money.of(50000))
            .sample();
    }
}
```

---

### 4. ê³„ì¸µë³„ Fixture êµ¬ì„±

```
src/test/java/vroong/laas/order/fixtures/
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ OrderFixtures.java          # Domain Entity
â”‚   â”œâ”€â”€ OrderItemFixtures.java
â”‚   â””â”€â”€ MoneyFixtures.java          # Value Object
â”œâ”€â”€ application/
â”‚   â”œâ”€â”€ CreateOrderCommandFixtures.java   # Command
â”‚   â””â”€â”€ CancelOrderCommandFixtures.java
â”œâ”€â”€ infrastructure/
â”‚   â””â”€â”€ OrderJpaEntityFixtures.java       # JPA Entity
â””â”€â”€ api/
    â”œâ”€â”€ CreateOrderRequestFixtures.java   # Request DTO
    â””â”€â”€ OrderResponseFixtures.java        # Response DTO
```

---

## ğŸ“ í…ŒìŠ¤íŠ¸ ì‘ì„± ê°€ì´ë“œ

### 1. Given-When-Then íŒ¨í„´

ëª¨ë“  í…ŒìŠ¤íŠ¸ëŠ” Given-When-Then êµ¬ì¡°ë¥¼ ë”°ë¦…ë‹ˆë‹¤.

```java
@Test
void test_example() {
    // given (ì¤€ë¹„)
    // - í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
    // - Mock ë™ì‘ ì •ì˜
    Order order = fixtureMonkey.giveMeOne(Order.class);
    given(orderStore.findById(1L)).willReturn(Optional.of(order));
    
    // when (ì‹¤í–‰)
    // - í…ŒìŠ¤íŠ¸í•  ë©”ì„œë“œ í˜¸ì¶œ
    Order result = orderService.getOrder(1L);
    
    // then (ê²€ì¦)
    // - ê²°ê³¼ ê²€ì¦
    // - ìƒíƒœ ë³€ê²½ ê²€ì¦
    // - Mock í˜¸ì¶œ ê²€ì¦
    assertThat(result).isEqualTo(order);
    verify(orderStore).findById(1L);
}
```

---

### 2. í…ŒìŠ¤íŠ¸ ë„¤ì´ë° ê·œì¹™

**í˜•ì‹:** `{í…ŒìŠ¤íŠ¸_ëŒ€ìƒ}_{ì¡°ê±´}_{ì˜ˆìƒ_ê²°ê³¼}`

```java
// âœ… ì¢‹ì€ ì˜ˆ
@Test
void cancel_order_with_pending_status_changes_to_cancelled() { }

@Test
void cancel_already_cancelled_order_throws_exception() { }

// âŒ ë‚˜ìœ ì˜ˆ
@Test
void test1() { }

@Test
void cancelTest() { }
```

---

### 3. @DisplayName í™œìš©

```java
@Test
@DisplayName("ëŒ€ê¸° ì¤‘ì¸ ì£¼ë¬¸ì„ ì·¨ì†Œí•˜ë©´ ìƒíƒœê°€ CANCELLEDë¡œ ë³€ê²½ëœë‹¤")
void cancel_order_with_pending_status_changes_to_cancelled() {
    // ...
}
```

---

### 4. ì˜ˆì™¸ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸

**í•„ìˆ˜ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤:**
- âœ… ì •ìƒ ì¼€ì´ìŠ¤ (Happy Path)
- âœ… ì˜ˆì™¸ ì¼€ì´ìŠ¤ (Exception)
- âœ… ê²½ê³„ê°’ ì¼€ì´ìŠ¤ (Boundary)
- âœ… Null ì¼€ì´ìŠ¤

**ì˜ˆì‹œ:**
```java
@Test
@DisplayName("ì£¼ë¬¸ ì·¨ì†Œ - ì •ìƒ ì¼€ì´ìŠ¤")
void cancel_order_success() { }

@Test
@DisplayName("ì£¼ë¬¸ ì·¨ì†Œ - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì£¼ë¬¸")
void cancel_order_not_found() {
    assertThatThrownBy(() -> orderService.cancel(999L))
        .isInstanceOf(OrderNotFoundException.class);
}

@Test
@DisplayName("ì£¼ë¬¸ ì·¨ì†Œ - ì´ë¯¸ ì·¨ì†Œëœ ì£¼ë¬¸")
void cancel_order_already_cancelled() {
    assertThatThrownBy(() -> order.cancel("reason"))
        .isInstanceOf(OrderAlreadyCancelledException.class);
}

@Test
@DisplayName("ì£¼ë¬¸ ì·¨ì†Œ - null reason")
void cancel_order_with_null_reason() {
    assertThatThrownBy(() -> order.cancel(null))
        .isInstanceOf(IllegalArgumentException.class);
}
```

---

### 5. AssertJ í™œìš©

```java
// ê¸°ë³¸ ê²€ì¦
assertThat(order.getStatus()).isEqualTo(OrderStatus.CANCELLED);

// ì»¬ë ‰ì…˜ ê²€ì¦
assertThat(orders)
    .hasSize(3)
    .extracting("status")
    .containsOnly(OrderStatus.PENDING);

// ì˜ˆì™¸ ê²€ì¦
assertThatThrownBy(() -> order.cancel("reason"))
    .isInstanceOf(OrderAlreadyCancelledException.class)
    .hasMessage("ì´ë¯¸ ì·¨ì†Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤");

// ê°ì²´ ê²€ì¦
assertThat(order)
    .extracting("id", "status", "totalAmount")
    .containsExactly(1L, OrderStatus.PENDING, Money.of(10000));
```

---

### 6. Mockito í™œìš©

```java
// Mock ë™ì‘ ì •ì˜
given(orderStore.findById(1L)).willReturn(Optional.of(order));

// void ë©”ì„œë“œ Mock
willDoNothing().given(eventPublisher).publish(any());

// ì˜ˆì™¸ ë˜ì§€ê¸°
given(orderStore.findById(999L))
    .willThrow(new OrderNotFoundException());

// í˜¸ì¶œ ê²€ì¦
verify(orderStore).save(order);
verify(eventPublisher).publish(any(OrderCancelledEvent.class));

// í˜¸ì¶œ íšŸìˆ˜ ê²€ì¦
verify(orderStore, times(1)).save(order);
verify(eventPublisher, never()).publish(any());

// ì¸ì ìº¡ì²˜
ArgumentCaptor<Order> captor = ArgumentCaptor.forClass(Order.class);
verify(orderStore).save(captor.capture());
assertThat(captor.getValue().getStatus()).isEqualTo(OrderStatus.CANCELLED);
```

---

## âœ… í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

ë§¤ ì‘ì—…ë§ˆë‹¤ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

### Domain Layer
- [ ] Entity ìƒì„± í…ŒìŠ¤íŠ¸
- [ ] ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í…ŒìŠ¤íŠ¸
- [ ] ì˜ˆì™¸ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸
- [ ] Value Object ë¶ˆë³€ì„± í…ŒìŠ¤íŠ¸

### Application Layer
- [ ] UseCase ì •ìƒ íë¦„ í…ŒìŠ¤íŠ¸
- [ ] UseCase ì˜ˆì™¸ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸
- [ ] Mock í˜¸ì¶œ ê²€ì¦
- [ ] Command/Query ìœ íš¨ì„± í…ŒìŠ¤íŠ¸

### Infrastructure Layer
- [ ] Repository ì €ì¥/ì¡°íšŒ í…ŒìŠ¤íŠ¸
- [ ] Query ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (N+1 ì²´í¬)
- [ ] íŠ¸ëœì­ì…˜ ê²©ë¦¬ í…ŒìŠ¤íŠ¸

### Interface Layer
- [ ] API ì •ìƒ ì‘ë‹µ í…ŒìŠ¤íŠ¸
- [ ] API ì˜ˆì™¸ ì‘ë‹µ í…ŒìŠ¤íŠ¸
- [ ] ìœ íš¨ì„± ê²€ì¦ í…ŒìŠ¤íŠ¸
- [ ] ì¸ì¦/ì¸ê°€ í…ŒìŠ¤íŠ¸
- [ ] REST Docs ë¬¸ì„œ ìƒì„± í™•ì¸ (snippets íŒŒì¼)
- [ ] Constraints ì»¬ëŸ¼ ì¶”ê°€ í™•ì¸
- [ ] ì»¤ìŠ¤í…€ í…œí”Œë¦¿ ê²½ë¡œ í™•ì¸ (`org/springframework/restdocs/templates/asciidoctor/`)

---

## ğŸš« ê¸ˆì§€ ì‚¬í•­

### 1. í…ŒìŠ¤íŠ¸ ì—†ì´ ì½”ë“œ ì‘ì„± ê¸ˆì§€
```java
// âŒ ì´ë ‡ê²Œ í•˜ì§€ ë§ˆì„¸ìš”
// í”„ë¡œë•ì…˜ ì½”ë“œë§Œ ì‘ì„±í•˜ê³  "ë‚˜ì¤‘ì— í…ŒìŠ¤íŠ¸ ì¶”ê°€"
```

### 2. Thread.sleep() ì‚¬ìš© ê¸ˆì§€
```java
// âŒ ë‚˜ìœ ì˜ˆ
@Test
void async_test() throws Exception {
    asyncService.process();
    Thread.sleep(1000);  // ê¸ˆì§€!
    verify(repository).save(any());
}

// âœ… ì¢‹ì€ ì˜ˆ - Awaitility ì‚¬ìš©
@Test
void async_test() {
    asyncService.process();
    
    await().atMost(Duration.ofSeconds(5))
        .untilAsserted(() -> {
            verify(repository).save(any());
        });
}
```

### 3. í…ŒìŠ¤íŠ¸ ê°„ ì˜ì¡´ì„± ê¸ˆì§€
```java
// âŒ ë‚˜ìœ ì˜ˆ - í…ŒìŠ¤íŠ¸ ìˆœì„œì— ì˜ì¡´
private static Order sharedOrder;

@Test
@Order(1)
void create_order() {
    sharedOrder = orderService.create(...);  // ê¸ˆì§€!
}

@Test
@Order(2)
void cancel_order() {
    orderService.cancel(sharedOrder.getId());  // ê¸ˆì§€!
}

// âœ… ì¢‹ì€ ì˜ˆ - ê° í…ŒìŠ¤íŠ¸ê°€ ë…ë¦½ì 
@Test
void cancel_order() {
    Order order = fixtureMonkey.giveMeOne(Order.class);
    orderService.cancel(order.getId());
}
```

### 4. ê³¼ë„í•œ Mock ì‚¬ìš© ê¸ˆì§€
```java
// âŒ ë‚˜ìœ ì˜ˆ - ë„ˆë¬´ ë§ì€ Mock
@Mock private Service1 service1;
@Mock private Service2 service2;
@Mock private Service3 service3;
// ... 10ê°œ ì´ìƒì˜ Mock

// ğŸ’¡ íŒíŠ¸: Mockì´ ë„ˆë¬´ ë§ë‹¤ë©´ ì„¤ê³„ë¥¼ ë‹¤ì‹œ ê²€í† í•˜ì„¸ìš”
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [JUnit 5 User Guide](https://junit.org/junit5/docs/current/user-guide/)
- [AssertJ Documentation](https://assertj.github.io/doc/)
- [Fixture Monkey Documentation](https://naver.github.io/fixture-monkey/)
- [Mockito Documentation](https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html)
- [Spring REST Docs](https://docs.spring.io/spring-restdocs/docs/current/reference/htmlsingle/)
- [Spring REST Docs - Custom Templates](https://docs.spring.io/spring-restdocs/docs/current/reference/htmlsingle/#documenting-your-api-customizing-including-snippets)

---

ì´ ê·œì¹™ì„ ë”°ë¼ ê²¬ê³ í•˜ê³  ìœ ì§€ë³´ìˆ˜ ê°€ëŠ¥í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”! ğŸš€

